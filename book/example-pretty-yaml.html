<!DOCTYPE HTML>
<html><head><title>Example: Pretty YAML</title></head><body><header><h1>Example: Pretty YAML</h1></header><article id="file180-example-pretty-yaml"><pre class="codeblock" id="file180-example-pretty-yaml/x1">&lt;p&gt;This example uses the &lt;a href=&quot;http://hackage.haskell.org/package/data-object-yaml&quot;&gt;data-object-yaml package&lt;/a&gt; to display YAML files as cleaned-up HTML. If you&#39;ve read through the other tutorials, this one should be easy to follow.&lt;/p&gt;

&gt; {-# LANGUAGE TypeFamilies, QuasiQuotes, TemplateHaskell, MultiParamTypeClasses, OverloadedStrings #-}

&gt; import Yesod
&gt; import Data.Object
&gt; import Data.Object.Yaml
&gt; import qualified Data.ByteString as B
&gt; import qualified Data.ByteString.Lazy as L

&gt; data PY = PY

&gt; mkYesod &quot;PY&quot; [parseRoutes|
&gt; / Homepage GET POST
&gt; |]

&gt; instance Yesod PY where approot _ = &quot;&quot;

&gt; template :: Maybe (HtmlUrl url) -&gt; HtmlUrl url
&gt; template myaml = [hamlet|
&gt; !!!
&gt; 
&gt; &lt;html&gt;
&gt;     &lt;head&gt;
&gt;         &lt;meta charset=&quot;utf-8&quot;&gt;
&gt;         &lt;title&gt;Pretty YAML
&gt;     &lt;body&gt;
&gt;         &lt;form method=&quot;post&quot; action=&quot;&quot; enctype=&quot;multipart/form-data&quot; .&gt;
&gt;             \File name:
&gt;             &lt;input type=&quot;file&quot; name=&quot;yaml&quot;&gt;
&gt;             &lt;input type=&quot;submit&quot;&gt;
&gt;         $maybe yaml &lt;- myaml
&gt;             &lt;div&gt;^{yaml}
&gt; |]

&gt; getHomepage :: Handler RepHtml
&gt; getHomepage = hamletToRepHtml $ template Nothing

&gt; postHomepage :: Handler RepHtml
&gt; postHomepage = do
&gt;     (_, files) &lt;- runRequestBody
&gt;     fi &lt;- case lookup &quot;yaml&quot; files of
&gt;             Nothing -&gt; invalidArgs [&quot;yaml: Missing input&quot;]
&gt;             Just x -&gt; return x
&gt;     so &lt;- liftIO $ decode $ B.concat $ L.toChunks $ fileContent fi
&gt;     hamletToRepHtml $ template $ Just $ objToHamlet so

&gt; objToHamlet :: StringObject -&gt; HtmlUrl url
&gt; objToHamlet (Scalar s) = [hamlet|#{s}|]
&gt; objToHamlet (Sequence list) = [hamlet|
&gt; &lt;ul
&gt;     $forall o &lt;- list
&gt;         &lt;li&gt;^{objToHamlet o}
&gt; |]
&gt; objToHamlet (Mapping pairs) = [hamlet|
&gt; &lt;dl
&gt;     $forall pair &lt;- pairs
&gt;         &lt;dt&gt;#{fst pair}
&gt;         &lt;dd&gt;^{objToHamlet $ snd pair}
&gt; |]

&gt; main :: IO ()
&gt; main = warpDebug 3000 PY
</pre></article></body></html>