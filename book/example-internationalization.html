<!DOCTYPE HTML>
<html><head><title>Example: Internationalization</title></head><body><header><h1>Example: Internationalization</h1></header><article id="file181-example-internationalization"><pre class="codeblock" id="file181-example-internationalization/x1">&gt; {-# LANGUAGE QuasiQuotes #-}
&gt; {-# LANGUAGE TemplateHaskell #-}
&gt; {-# LANGUAGE TypeFamilies #-}
&gt; {-# LANGUAGE MultiParamTypeClasses #-}
&gt; {-# LANGUAGE OverloadedStrings #-}

&gt; import Yesod
&gt; import Data.Monoid (mempty)
&gt; import Data.Text (Text)

&gt; data I18N = I18N

&gt; mkYesod &quot;I18N&quot; [parseRoutes|
&gt; /            HomepageR GET
&gt; /set/#Text SetLangR  GET
&gt; |]

&gt; instance Yesod I18N where
&gt;     approot _ = &quot;http://localhost:3000&quot;

&gt; getHomepageR :: Handler RepHtml
&gt; getHomepageR = do
&gt;     ls &lt;- languages
&gt;     let hello = chooseHello ls
&gt;     let choices =
&gt;             [ (&quot;en&quot;, &quot;English&quot;) :: (Text, Text)
&gt;             , (&quot;es&quot;, &quot;Spanish&quot;)
&gt;             , (&quot;he&quot;, &quot;Hebrew&quot;)
&gt;             ]
&gt;     defaultLayout $ do
&gt;       setTitle &quot;I18N Homepage&quot;
&gt;       addHamlet [hamlet|
&gt; &lt;h1&gt;#{hello}
&gt; &lt;p&gt;In other languages:
&gt; &lt;ul&gt;
&gt;     $forall choice &lt;- choices
&gt;         &lt;li&gt;
&gt;             &lt;a href=&quot;@{SetLangR (fst choice)}&quot;&gt;#{snd choice}
&gt; |]

&gt; chooseHello :: [Text] -&gt; Text
&gt; chooseHello [] = &quot;Hello&quot;
&gt; chooseHello (&quot;he&quot;:_) = &quot;Shalom&quot;
&gt; chooseHello (&quot;es&quot;:_) = &quot;Hola&quot;
&gt; chooseHello (_:rest) = chooseHello rest

&gt; getSetLangR :: Text -&gt; Handler ()
&gt; getSetLangR lang = do
&gt;     setLanguage lang
&gt;     redirect RedirectTemporary HomepageR

&gt; main :: IO ()
&gt; main = warpDebug 3000 I18N
</pre></article></body></html>